\chapter{$P_N$-Method for Multiple Scattering in Participating Media}
%
\label{sec:pnmethod}

The $P_N$-method presented in this chapter is a deterministic method for solving the radiative transfer equation. It is based on the spherical harmonics discretization of the radiative transfer equation and its related quantities in angular domain. The underlying theory has its origins in astrophysics (see Brunner~\cite{Brunner02}) and is also popular in nuclear sciences (see Seibold et al.~\cite{Seibold14}) and medical science (see Frank et al.\cite{Frank08}). Within the field of computer graphics, $P_N$-theory was discussed briefly in a paper by Kajia~\cite{Kajiya84} without any details on how to solve the equations. In fact, as Max~\cite{Max95} pointed out, it is not clear if Kajiya succeeded at all at implementing a method for solving the $P_N$-equations, as all of the results in his paper were produced with a simpler method\footnote{\cite{Max95} p.4: \emph{``[...] Kajiya attempted to solve these equations for the case of isotropic scattering, but it is unclear whether he succeeded, since all the pictures in \cite{Kajiya84} were produced by the simpler 'slab' method.[...]"}}. This doubt is further strengthened by results in this thesis, which show that a straight forward finite difference discretization of the $P_N$-equations produces unuseable results, due to oscillation artifacts in the solution. 

In this chapter, we will give a thorough derivation of the $P_N$-theory and introduce a novel method for solving the underlying equations. The first section introduces the spherical harmonics expansion and important properties. Then the complex-valued $P_N$-equations are derived in section~\ref{sec:pn_cvalued}. The fact, that the radiance field is real-valued can be used to cut the number of unknowns in half. This is done by using the real-valued $P_N$-equations. In section~\ref{sec:pn_rvalued}, a very compact form of the real-valued $P_N$-equations is derived, which has not been given anywhere else in the literature before. After a short note on two-dimensional problems in section~\ref{sec:pn_2d}, The chapter continues by introducing a new method for solving the $P_N$-equations (section~\ref{sec:pn_solver}) and closes by discussing its integration into a rendering framework and giving results (section~\ref{sec:pn_results}).

\input{04_pn_method/spherical_harmonics}
\input{04_pn_method/cvalued_pn_equations}
\input{04_pn_method/rvalued_pn_equations}
\input{04_pn_method/2dproblems}
\input{04_pn_method/pnsolver}
\input{04_pn_method/rendering_integration}
\input{04_pn_method/results}
\input{04_pn_method/discussion}