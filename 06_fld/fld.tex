\chapter{Flux-limited Diffusion}
\label{sec:fld}

We have seen in the previous chapter, that the first order truncation of the $P_N$-equations can be collapsed into a simple diffusion equation, which has a low memory footprint and can be solved very efficiently using a Multigrid solver. The diffusion approximation therefore offers significant advantages over the $P_N$-method in terms of required computational resources. At the same time, it gives only a poor approximation to the ground truth result, due to the very coarse angular discretization.

In this chapter, flux-limited diffusion is introduced to the problem of rendering participating media in computer graphics. The theory has been invented in the astrophysics domain and is primarily contributed to Levermore et al.~\cite{Levermore81}. Their work introduces the theory and discusses its properties for certain canonical problems, such as a single point source within a homogeneous participating medium. In this chapter, a novel numerical method is deviced, based on flux-limited diffusion theory. It allows to solve for the fluence on a finite difference grid with much higher accuracy at a much lower cost, when compared to classic diffusion approximation. The results have been published in~\cite{Koerner14}.

The chapter continues to introduce a different view on the spherical harmonics expansion of the radiative transfer equation, called the moment equations. Instead of representing the $P_N$-equations as scalar partial differential equations for each spherical harmonics coefficient ($l,m$-pair), the moment equations use tensor notation to produce a very compact and concise equation for each spherical harmonic band. This alternative representation is often used in the literature, because it allows to present theoretical ideas much clearer at the expense of introducing redundance. This is, why for numerical methods, the spherical harmonics representation is often preferred.

After introducing the moment equations, two extreme transport scenarios are derived. First the diffusion limit in section~\ref{sec:fld_diffusion_approximation}, followed by the streaming limit in section~\ref{sec:fld_streaming_limit_approximation}. Finally, flux-limited diffusion is derived as a means to blend between the two extreme modes of transport using local information. This blending is driven by the variable eddington factor, which introduced in section~\ref{sec:fld_vef}. Various concrete realizations of the eddington factor are given and compared in section~\ref{sec:fld_vef_factors}. Finally, an iterative solver is presented in section~\ref{sec:fld_solver}. The chapter concludes with results in section~\ref{sec:fld_results}.


\input{06_fld/moment_problem_revisited}
\input{06_fld/delta_distribution}
\input{06_fld/vef}






\section{Eddington Factors and Flux-limiters}
\label{sec:fld_vef_factors}

\section{Non-Linear Gauss-Seidel Solver with Successive Overrelaxation}
\label{sec:fld_solver}

\section{Results}
\label{sec:fld_results}

\TD{mention publication}
\TD{mention application in elementacular}